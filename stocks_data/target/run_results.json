{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.1", "generated_at": "2024-12-26T18:07:13.796115Z", "invocation_id": "8ff940bc-768b-4c0c-b913-10e93c0b3d92", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-26T18:07:12.230076Z", "completed_at": "2024-12-26T18:07:12.234581Z"}, {"name": "execute", "started_at": "2024-12-26T18:07:12.235587Z", "completed_at": "2024-12-26T18:07:13.179061Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.9489850997924805, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b94b1f-3201-5da7-000a-cf6e000f3d36"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.stocks_data.stage_stock_data", "compiled": true, "compiled_code": "WITH raw_data AS (\n    SELECT\n        SYMBOL,\n        TIMESTAMP,\n        CAST(OPEN AS FLOAT) AS OPEN_PRICE,\n        CAST(HIGH AS FLOAT) AS HIGH_PRICE,\n        CAST(LOW AS FLOAT) AS LOW_PRICE,\n        CAST(CLOSE AS FLOAT) AS CLOSE_PRICE,\n        CAST(VOLUME AS NUMBER(19,0)) AS VOLUME,\n        CAST(DIVIDENDS AS FLOAT) AS DIVIDENDS,\n        STOCKSPLITS,\n        RECORD_METADATA\n    FROM STOCKS.raw.stock_prices_all\n),\n\ncalculated_measures AS (\n    SELECT\n        SYMBOL,\n        TIMESTAMP,\n        OPEN_PRICE,\n        HIGH_PRICE,\n        LOW_PRICE,\n        CLOSE_PRICE,\n        VOLUME,\n        DIVIDENDS,\n        STOCKSPLITS,\n\n        -- Daily Price Range\n        HIGH_PRICE - LOW_PRICE AS DAILY_PRICE_RANGE,\n\n        -- Daily Percentage Change\n        ((CLOSE_PRICE - OPEN_PRICE) / NULLIF(OPEN_PRICE, 0)) * 100 AS DAILY_PERCENT_CHANGE,\n\n        -- Rolling Averages\n        AVG(CLOSE_PRICE) OVER (PARTITION BY SYMBOL ORDER BY TIMESTAMP ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS AVG_CLOSE_7D,\n        AVG(CLOSE_PRICE) OVER (PARTITION BY SYMBOL ORDER BY TIMESTAMP ROWS BETWEEN 29 PRECEDING AND CURRENT ROW) AS AVG_CLOSE_30D,\n\n        -- Max-Min Spread\n        MAX(CLOSE_PRICE) OVER (PARTITION BY SYMBOL) - MIN(CLOSE_PRICE) OVER (PARTITION BY SYMBOL) AS MAX_MIN_SPREAD,\n\n        -- Total Dividends\n        SUM(DIVIDENDS) OVER (PARTITION BY SYMBOL) AS TOTAL_DIVIDENDS,\n\n        -- Count of Stock Splits\n        COUNT(DISTINCT STOCKSPLITS) OVER (PARTITION BY SYMBOL) AS STOCK_SPLIT_COUNT\n    FROM raw_data\n)\n\nSELECT * FROM calculated_measures", "relation_name": "STOCKS.STAGE.stage_stock_data", "batch_results": null}], "elapsed_time": 3.521156072616577, "args": {"macro_debugging": false, "skip_nodes_if_on_run_start_fails": false, "profiles_dir": "C:\\Users\\naush\\.dbt", "use_colors": true, "log_file_max_bytes": 10485760, "write_json": true, "strict_mode": false, "static_parser": true, "printer_width": 80, "favor_state": false, "project_dir": "D:\\dbt\\stocks_data", "source_freshness_run_project_hooks": false, "require_explicit_package_overrides_for_builtin_materializations": true, "state_modified_compare_vars": false, "send_anonymous_usage_stats": true, "log_path": "D:\\dbt\\stocks_data\\logs", "use_colors_file": true, "warn_error_options": {"include": [], "exclude": []}, "state_modified_compare_more_unrendered_values": false, "populate_cache": true, "which": "run", "cache_selected_only": false, "exclude": [], "vars": {}, "require_nested_cumulative_type_params": false, "version_check": true, "log_format_file": "debug", "log_level_file": "debug", "quiet": false, "log_format": "default", "select": [], "require_resource_names_without_spaces": false, "log_level": "info", "invocation_command": "dbt run", "defer": false, "partial_parse_file_diff": true, "show_resource_report": false, "require_yaml_configuration_for_mf_time_spines": false, "partial_parse": true, "require_batched_execution_for_custom_microbatch_strategy": false, "introspect": true, "empty": false, "print": true, "indirect_selection": "eager"}}